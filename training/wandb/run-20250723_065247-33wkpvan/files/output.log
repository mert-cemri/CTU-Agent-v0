InferenceEngineClient initialized with 2 engines.
Total steps: 5
Validation set size: 1
2025-07-23 06:54:46.877 | INFO     | skyrl_train.workers.worker:_initiate_actors:543 - Initializing process group for RayActorGroup
2025-07-23 06:54:55.087 | INFO     | skyrl_train.workers.worker:_initiate_actors:545 - Initialized process group for RayActorGroup
2025-07-23 06:54:55.103 | INFO     | skyrl_train.workers.worker:_initiate_actors:547 - Mesh Ranks: [MeshRank(dp=0, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=1, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=2, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=3, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=4, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=5, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=6, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=7, sp=0, tp=0, world_size=8, dp_size=8)]
2025-07-23 06:55:02.476 | INFO     | skyrl_train.workers.worker:_initiate_actors:543 - Initializing process group for RayActorGroup
2025-07-23 06:55:10.733 | INFO     | skyrl_train.workers.worker:_initiate_actors:545 - Initialized process group for RayActorGroup
2025-07-23 06:55:10.750 | INFO     | skyrl_train.workers.worker:_initiate_actors:547 - Mesh Ranks: [MeshRank(dp=0, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=1, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=2, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=3, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=4, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=5, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=6, sp=0, tp=0, world_size=8, dp_size=8), MeshRank(dp=7, sp=0, tp=0, world_size=8, dp_size=8)]
2025-07-23 06:55:50.179 | INFO     | skyrl_train.trainer:build_models:603 - init policy/ref/critic/reward models done
2025-07-23 06:55:50.179 | INFO     | skyrl_train.trainer:train:212 - Started: 'load_checkpoints'
2025-07-23 06:55:50.180 | INFO     | skyrl_train.trainer:load_checkpoints:1207 - Loading checkpoint from: /root/ckpts/tau_bench/global_step_6
2025-07-23 06:55:50.180 | INFO     | skyrl_train.trainer:load_checkpoints:1217 - Resuming from global_step: 6
2025-07-23 06:55:50.186 | INFO     | skyrl_train.trainer:load_checkpoints:1232 - Successfully loaded trainer state
2025-07-23 06:55:50.187 | INFO     | skyrl_train.trainer:load_checkpoints:1241 - Successfully loaded dataloader state
2025-07-23 06:55:50.187 | INFO     | skyrl_train.trainer:load_checkpoints:1250 - Loading policy checkpoint from /root/ckpts/tau_bench/global_step_6/policy
2025-07-23 06:55:51.142 | INFO     | skyrl_train.trainer:load_checkpoints:1260 - Successfully loaded policy checkpoint
2025-07-23 06:55:51.143 | INFO     | skyrl_train.trainer:load_checkpoints:1276 - Successfully loaded complete checkpoint state from global_step_6
2025-07-23 06:55:51.143 | INFO     | skyrl_train.trainer:train:214 - Resumed training from global_step 6
2025-07-23 06:55:51.143 | INFO     | skyrl_train.trainer:train:212 - Finished: 'load_checkpoints', time cost: 0.96s
2025-07-23 06:55:51.143 | INFO     | skyrl_train.trainer:train:217 - Started: 'setup_policy_and_generator'
2025-07-23 06:55:51.259 | INFO     | skyrl_train.trainer:setup_policy_and_generator:614 - Initialized weight sync state for policy model and inference engines.
2025-07-23 06:55:51.415 | INFO     | skyrl_train.trainer:train:217 - Finished: 'setup_policy_and_generator', time cost: 0.27s
2025-07-23 06:55:51.569 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 06:55:51.739 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.17s
2025-07-23 06:55:51.835 | INFO     | skyrl_train.trainer:train:225 - Started: 'eval'
Generating Trajectories: 100%|██████████| 25/25 [01:06<00:00,  2.65s/it]
2025-07-23 06:57:35.214 | INFO     | skyrl_train.trainer:eval:177 - Started: 'dump_eval_results'
Dumped eval data for tau_bench to /root/exports/tau_bench/dumped_evals/global_step_6_evals/tau_bench.jsonl
Dumped aggregated eval metrics to /root/exports/tau_bench/dumped_evals/global_step_6_evals/aggregated_results.jsonl
2025-07-23 06:57:35.253 | INFO     | skyrl_train.trainer:eval:177 - Finished: 'dump_eval_results', time cost: 0.04s
Evaluation Progress: 100%|██████████| 1/1 [01:43<00:00, 103.42s/it]
2025-07-23 06:57:35.257 | INFO     | skyrl_train.trainer:train:225 - Finished: 'eval', time cost: 103.42s
Training Step Progress: 6it [00:00, ?it/s]2025-07-23 06:58:50.400 | INFO     | skyrl_train.trainer:train:237 - Started: 'step'
2025-07-23 06:58:50.599 | INFO     | skyrl_train.weights_manager:__enter__:56 - Started: 'sync_weights_to_inference_engines'
2025-07-23 06:58:56.994 | INFO     | skyrl_train.weights_manager:__enter__:56 - Finished: 'sync_weights_to_inference_engines', time cost: 6.40s
2025-07-23 06:58:56.995 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 06:58:57.175 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.18s
2025-07-23 06:58:57.267 | INFO     | skyrl_train.trainer:train:250 - Started: 'generate'
Generating Trajectories: 100%|██████████| 768/768 [26:07<00:00,  2.04s/it]
2025-07-23 07:25:04.467 | INFO     | skyrl_train.trainer:train:250 - Finished: 'generate', time cost: 1567.20s
2025-07-23 07:25:07.355 | INFO     | skyrl_train.trainer:train:254 - Started: 'postprocess_generator_output'
2025-07-23 07:25:07.359 | INFO     | skyrl_train.trainer:postprocess_generator_output:740 - Filtered out 768 empty responses.
2025-07-23 07:25:07.469 | INFO     | skyrl_train.trainer:train:254 - Finished: 'postprocess_generator_output', time cost: 0.11s
2025-07-23 07:25:07.470 | WARNING  | skyrl_train.trainer:train:260 - Skipping training step because the entire batch was invalid.
Training Step Progress: 7it [27:30, 1650.91s/it]2025-07-23 07:25:07.470 | INFO     | skyrl_train.trainer:train:237 - Finished: 'step', time cost: 1577.07s
2025-07-23 07:25:45.015 | INFO     | skyrl_train.trainer:train:237 - Started: 'step'
2025-07-23 07:25:45.275 | INFO     | skyrl_train.weights_manager:__enter__:56 - Started: 'sync_weights_to_inference_engines'
2025-07-23 07:25:49.827 | INFO     | skyrl_train.weights_manager:__enter__:56 - Finished: 'sync_weights_to_inference_engines', time cost: 4.55s
2025-07-23 07:25:49.828 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 07:25:49.890 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.06s
2025-07-23 07:25:49.980 | INFO     | skyrl_train.trainer:train:250 - Started: 'generate'
Generating Trajectories: 100%|██████████| 768/768 [28:17<00:00,  2.21s/it]
2025-07-23 07:54:07.804 | INFO     | skyrl_train.trainer:train:250 - Finished: 'generate', time cost: 1697.82s
2025-07-23 07:54:08.821 | INFO     | skyrl_train.trainer:train:254 - Started: 'postprocess_generator_output'
2025-07-23 07:54:08.825 | INFO     | skyrl_train.trainer:postprocess_generator_output:740 - Filtered out 768 empty responses.
2025-07-23 07:54:08.905 | INFO     | skyrl_train.trainer:train:254 - Finished: 'postprocess_generator_output', time cost: 0.08s
2025-07-23 07:54:08.905 | WARNING  | skyrl_train.trainer:train:260 - Skipping training step because the entire batch was invalid.
Training Step Progress: 8it [56:32, 1704.16s/it]2025-07-23 07:54:08.906 | INFO     | skyrl_train.trainer:train:237 - Finished: 'step', time cost: 1703.89s
2025-07-23 07:54:46.366 | INFO     | skyrl_train.trainer:train:237 - Started: 'step'
2025-07-23 07:54:46.586 | INFO     | skyrl_train.weights_manager:__enter__:56 - Started: 'sync_weights_to_inference_engines'
2025-07-23 07:54:51.158 | INFO     | skyrl_train.weights_manager:__enter__:56 - Finished: 'sync_weights_to_inference_engines', time cost: 4.57s
2025-07-23 07:54:51.158 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 07:54:51.224 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.07s
2025-07-23 07:54:51.311 | INFO     | skyrl_train.trainer:train:250 - Started: 'generate'
Generating Trajectories: 100%|██████████| 768/768 [26:27<00:00,  2.07s/it]
2025-07-23 08:21:19.199 | INFO     | skyrl_train.trainer:train:250 - Finished: 'generate', time cost: 1587.89s
2025-07-23 08:21:20.305 | INFO     | skyrl_train.trainer:train:254 - Started: 'postprocess_generator_output'
2025-07-23 08:21:20.310 | INFO     | skyrl_train.trainer:postprocess_generator_output:740 - Filtered out 768 empty responses.
2025-07-23 08:21:20.382 | INFO     | skyrl_train.trainer:train:254 - Finished: 'postprocess_generator_output', time cost: 0.08s
2025-07-23 08:21:20.383 | WARNING  | skyrl_train.trainer:train:260 - Skipping training step because the entire batch was invalid.
Training Step Progress: 9it [1:23:43, 1670.97s/it]2025-07-23 08:21:20.383 | INFO     | skyrl_train.trainer:train:237 - Finished: 'step', time cost: 1594.02s
2025-07-23 08:21:57.923 | INFO     | skyrl_train.trainer:train:237 - Started: 'step'
2025-07-23 08:21:58.139 | INFO     | skyrl_train.weights_manager:__enter__:56 - Started: 'sync_weights_to_inference_engines'
2025-07-23 08:22:02.928 | INFO     | skyrl_train.weights_manager:__enter__:56 - Finished: 'sync_weights_to_inference_engines', time cost: 4.79s
2025-07-23 08:22:02.928 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 08:22:02.989 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.06s
2025-07-23 08:22:03.076 | INFO     | skyrl_train.trainer:train:250 - Started: 'generate'
Generating Trajectories: 100%|██████████| 768/768 [28:39<00:00,  2.24s/it]
2025-07-23 08:50:42.622 | INFO     | skyrl_train.trainer:train:250 - Finished: 'generate', time cost: 1719.55s
2025-07-23 08:50:43.628 | INFO     | skyrl_train.trainer:train:254 - Started: 'postprocess_generator_output'
2025-07-23 08:50:43.632 | INFO     | skyrl_train.trainer:postprocess_generator_output:740 - Filtered out 768 empty responses.
2025-07-23 08:50:43.706 | INFO     | skyrl_train.trainer:train:254 - Finished: 'postprocess_generator_output', time cost: 0.08s
2025-07-23 08:50:43.706 | WARNING  | skyrl_train.trainer:train:260 - Skipping training step because the entire batch was invalid.
Training Step Progress: 10it [1:53:07, 1707.43s/it]2025-07-23 08:50:43.707 | INFO     | skyrl_train.trainer:train:237 - Finished: 'step', time cost: 1725.78s
2025-07-23 08:51:21.406 | INFO     | skyrl_train.trainer:train:237 - Started: 'step'
2025-07-23 08:51:21.739 | INFO     | skyrl_train.weights_manager:__enter__:56 - Started: 'sync_weights_to_inference_engines'
2025-07-23 08:51:26.341 | INFO     | skyrl_train.weights_manager:__enter__:56 - Finished: 'sync_weights_to_inference_engines', time cost: 4.60s
2025-07-23 08:51:26.341 | INFO     | skyrl_train.weights_manager:__enter__:60 - Started: 'offload_policy_model_to_cpu'
2025-07-23 08:51:26.401 | INFO     | skyrl_train.weights_manager:__enter__:60 - Finished: 'offload_policy_model_to_cpu', time cost: 0.06s
2025-07-23 08:51:26.490 | INFO     | skyrl_train.trainer:train:250 - Started: 'generate'
Generating Trajectories: 100%|██████████| 768/768 [26:08<00:00,  2.04s/it]
2025-07-23 09:17:35.201 | INFO     | skyrl_train.trainer:train:250 - Finished: 'generate', time cost: 1568.71s
2025-07-23 09:17:36.231 | INFO     | skyrl_train.trainer:train:254 - Started: 'postprocess_generator_output'
2025-07-23 09:17:36.235 | INFO     | skyrl_train.trainer:postprocess_generator_output:740 - Filtered out 768 empty responses.
2025-07-23 09:17:36.357 | INFO     | skyrl_train.trainer:train:254 - Finished: 'postprocess_generator_output', time cost: 0.13s
2025-07-23 09:17:36.358 | WARNING  | skyrl_train.trainer:train:260 - Skipping training step because the entire batch was invalid.
Training Step Progress: 11it [2:19:59, 1673.25s/it]2025-07-23 09:17:36.358 | INFO     | skyrl_train.trainer:train:237 - Finished: 'step', time cost: 1574.95s
Training Step Progress: 11it [2:20:00, 1680.18s/it]
2025-07-23 09:17:37.463 | INFO     | skyrl_train.trainer:train:345 - Started: 'save_checkpoints'
2025-07-23 09:17:38.463 | INFO     | skyrl_train.trainer:save_checkpoints:1126 - Saved dataloader state to /root/ckpts/tau_bench/global_step_12/data.pt
2025-07-23 09:17:38.468 | INFO     | skyrl_train.trainer:save_checkpoints:1137 - Saved trainer state to /root/ckpts/tau_bench/global_step_12/trainer_state.pt
2025-07-23 09:17:38.469 | INFO     | skyrl_train.trainer:save_checkpoints:1144 - Successfully saved checkpoint for global_step_12 to: /root/ckpts/tau_bench/global_step_12
2025-07-23 09:17:38.469 | INFO     | skyrl_train.trainer:save_checkpoints:1147 - Started: 'cleanup_old_checkpoints'
2025-07-23 09:17:44.537 | INFO     | skyrl_train.utils.trainer_utils:cleanup_old_checkpoints:103 - Only 2 checkpoints found for the current run, no need to cleanup
2025-07-23 09:17:44.537 | INFO     | skyrl_train.trainer:save_checkpoints:1147 - Finished: 'cleanup_old_checkpoints', time cost: 6.07s
2025-07-23 09:17:44.537 | INFO     | skyrl_train.trainer:train:347 - Saved final checkpoint.
2025-07-23 09:17:44.537 | INFO     | skyrl_train.trainer:train:345 - Finished: 'save_checkpoints', time cost: 7.07s
2025-07-23 09:17:44.538 | INFO     | skyrl_train.trainer:train:349 - Started: 'save_hf_model'
2025-07-23 09:18:01.180 | INFO     | skyrl_train.trainer:save_models:1294 - Successfully saved model weights.
2025-07-23 09:18:01.181 | INFO     | skyrl_train.trainer:train:351 - Saved final model.
2025-07-23 09:18:01.181 | INFO     | skyrl_train.trainer:train:349 - Finished: 'save_hf_model', time cost: 16.64s
2025-07-23 09:18:01.182 | INFO     | skyrl_train.trainer:train:352 - Training done!
